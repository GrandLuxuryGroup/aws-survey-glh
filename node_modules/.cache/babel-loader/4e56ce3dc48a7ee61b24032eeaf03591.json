{"ast":null,"code":"import _regeneratorRuntime from\"/Users/christophe/dev/amplify/glh-survey/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/christophe/dev/amplify/glh-survey/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/christophe/dev/amplify/glh-survey/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/christophe/dev/amplify/glh-survey/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _createSuper from\"/Users/christophe/dev/amplify/glh-survey/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _inherits from\"/Users/christophe/dev/amplify/glh-survey/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React from\"react\";import{Auth,Hub}from'aws-amplify';import Navbar from'./components/NavBar';import Logo from'./images/GL-Group-BLACK-RVB.jpg';import{Authenticator}from\"aws-amplify-react\";import createBrowserHistory from'history/createBrowserHistory';import{Router,Route}from'react-router-dom';import HomePage from'./pages/HomePage';import FinalPage from'./pages/FinalPage';import\"@aws-amplify/ui/dist/style.css\";export var UserContext=React.createContext();export var history=createBrowserHistory();var AppWithAuth=/*#__PURE__*/function(_React$Component){_inherits(AppWithAuth,_React$Component);var _super=_createSuper(AppWithAuth);function AppWithAuth(){var _this;_classCallCheck(this,AppWithAuth);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={user:null,userAttributes:null};_this.getUserData=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Auth.currentAuthenticatedUser();case 2:user=_context.sent;user?_this.setState({user:user},function(){return _this.getUserAttributes(_this.state.user);}):_this.setState({user:null});case 4:case\"end\":return _context.stop();}}},_callee);}));_this.getUserAttributes=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(authUserData){var attributesArr;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:attributesArr=Auth.userAttributes(authUserData).then(function(data){var attributesObj=Auth.attributesToObject(data);_this.setState({userAttributes:attributesObj});});case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}();_this.handleSignOut=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return Auth.signOut();case 3:_context3.next=8;break;case 5:_context3.prev=5;_context3.t0=_context3[\"catch\"](0);console.error('Error signing out the user',_context3.t0);case 8:case\"end\":return _context3.stop();}}},_callee3,null,[[0,5]]);}));_this.onHubCapsule=function(capsule){switch(capsule.payload.event){case\"signIn\":console.log('signed in');console.log(capsule.payload.event);console.log(_this.state.userAttributes);_this.getUserData();break;case\"signUp\":console.log('signed up');console.log(capsule);break;case\"signOut\":console.log('signed out');_this.setState({user:null});break;default:return;}};return _this;}_createClass(AppWithAuth,[{key:\"componentDidMount\",value:function componentDidMount(){this.getUserData();Hub.listen('auth',this,'onHubCapsule');}},{key:\"render\",value:function render(){var _this$state=this.state,user=_this$state.user,userAttributes=_this$state.userAttributes;var signUpConfig={hiddenDefaults:[\"phone_number\"],signUpFields:[{label:'Hotel Name',key:'custom:HotelName',required:true,placeholder:'Hotel Name',type:'string',displayOrder:4}]//hideAllDefaults: true,\n/*signUpFields: [\n            {\n                label: 'UserName',\n                key: 'username',\n                required: true,\n                placeholder: 'UserName',\n                type: 'email',\n                displayOrder: 1,\n              },\n          {\n            label: 'Email',\n            key: 'email',\n            required: true,\n            placeholder: 'Email',\n            type: 'email',\n            displayOrder: 2,\n          },\n          {\n            label: 'Password',\n            key: 'password',\n            required: true,\n            placeholder: 'Password',\n            type: 'password',\n            displayOrder: 3,\n          },\n          ,\n        ]*/};return!user?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{style:{alignContent:'center'}},/*#__PURE__*/React.createElement(\"img\",{src:Logo,alt:\"GLH Logo\",style:{width:'250px',display:'block',margin:'auto',marginTop:'30px'}})),/*#__PURE__*/React.createElement(Authenticator,{signUpConfig:signUpConfig})):/*#__PURE__*/React.createElement(UserContext.Provider,{value:{user:user,userAttributes:userAttributes}},/*#__PURE__*/React.createElement(Router,{history:history},/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Navbar,{user:user,handleSignOut:this.handleSignOut}),/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/\",component:HomePage}),/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/Final\",component:FinalPage}))));}}]);return AppWithAuth;}(React.Component);export default AppWithAuth;","map":{"version":3,"sources":["/Users/christophe/dev/amplify/glh-survey/src/AppWithAuth.js"],"names":["React","Auth","Hub","Navbar","Logo","Authenticator","createBrowserHistory","Router","Route","HomePage","FinalPage","UserContext","createContext","history","AppWithAuth","state","user","userAttributes","getUserData","currentAuthenticatedUser","setState","getUserAttributes","authUserData","attributesArr","then","data","attributesObj","attributesToObject","handleSignOut","signOut","console","error","onHubCapsule","capsule","payload","event","log","listen","signUpConfig","hiddenDefaults","signUpFields","label","key","required","placeholder","type","displayOrder","alignContent","width","display","margin","marginTop","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport {Auth, Hub}  from 'aws-amplify'\nimport Navbar from './components/NavBar'\nimport Logo from './images/GL-Group-BLACK-RVB.jpg';\nimport { Authenticator } from \"aws-amplify-react\";\nimport createBrowserHistory from 'history/createBrowserHistory';\nimport { Router, Route} from 'react-router-dom';\nimport HomePage from './pages/HomePage';\nimport FinalPage from './pages/FinalPage';\nimport \"@aws-amplify/ui/dist/style.css\";\n\nexport const UserContext = React.createContext();\n\nexport const history = createBrowserHistory();\n\nclass AppWithAuth extends React.Component {\n  state = {\n      user : null,\n      userAttributes : null,\n  }\n\n  componentDidMount() {\n    this.getUserData();\n    Hub.listen('auth', this, 'onHubCapsule');\n  }\n\n  getUserData = async () => { \n    const user = await  Auth.currentAuthenticatedUser();\n    user ? this.setState({user}, () => this.getUserAttributes(this.state.user)) : this.setState({user : null});\n  }\n\n  getUserAttributes = async authUserData  => {\n    const attributesArr = Auth.userAttributes(authUserData).then(data => {\n      const attributesObj = Auth.attributesToObject(data);\n      this.setState({ userAttributes : attributesObj });\n    });\n\n  }\n\n  handleSignOut = async () =>{\n    try {\n      await Auth.signOut()\n    } catch(err){\n      console.error('Error signing out the user', err);\n    }\n  }\n\n  onHubCapsule = capsule => {\n    switch (capsule.payload.event) {\n      case \"signIn\" :\n        console.log('signed in');\n        console.log(capsule.payload.event);\n        console.log(this.state.userAttributes);\n        this.getUserData();\n        break;\n      case \"signUp\":\n          console.log('signed up');\n          console.log(capsule);\n        break;\n      case \"signOut\":\n        console.log('signed out');\n        this.setState({user: null});\n        break;\n      default : \n        return;\n    }\n  }\n\n \n\n  render() {\n    const { user, userAttributes } = this.state;\n    \n    const signUpConfig = {\n        hiddenDefaults: [\"phone_number\"],\n        signUpFields: [\n            {\n                label: 'Hotel Name',\n                key: 'custom:HotelName',\n                required: true,\n                placeholder: 'Hotel Name',\n                type: 'string',\n                displayOrder: 4,\n              }\n        ]\n        //hideAllDefaults: true,\n        /*signUpFields: [\n            {\n                label: 'UserName',\n                key: 'username',\n                required: true,\n                placeholder: 'UserName',\n                type: 'email',\n                displayOrder: 1,\n              },\n          {\n            label: 'Email',\n            key: 'email',\n            required: true,\n            placeholder: 'Email',\n            type: 'email',\n            displayOrder: 2,\n          },\n          {\n            label: 'Password',\n            key: 'password',\n            required: true,\n            placeholder: 'Password',\n            type: 'password',\n            displayOrder: 3,\n          },\n          ,\n        ]*/,\n      }\n    return (\n        !user ?  (\n            <>\n            <div style={{alignContent:'center'}}>\n                <img src={Logo} alt=\"GLH Logo\" style={{width:'250px',display: 'block', margin: 'auto', marginTop:'30px'}}></img>\n            </div>\n            <Authenticator signUpConfig={signUpConfig}/>\n            </>\n          ) : (\n            <UserContext.Provider value={{ user, userAttributes}}>\n                <Router history={history}> \n                    <React.Fragment>\n                        <Navbar user={user} handleSignOut={this.handleSignOut}/>\n                    \n                        <Route exact path=\"/\" component ={HomePage} />\n                        <Route exact path=\"/Final\" component ={FinalPage} />\n                    </React.Fragment>\n                </Router>\n            </UserContext.Provider>)\n  \n    );\n  }\n}\n\nexport default AppWithAuth;"]},"metadata":{},"sourceType":"module"}