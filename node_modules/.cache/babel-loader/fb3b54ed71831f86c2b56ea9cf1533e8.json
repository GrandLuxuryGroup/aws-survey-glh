{"ast":null,"code":"var _jsxFileName = \"/Users/christophe/dev/amplify/glh-survey/src/components/SurveyComponent.js\";\nimport React, { Component } from \"react\";\nimport * as Survey from \"survey-react\";\nimport \"survey-react/survey.css\";\nimport { createSurvey, createTracking, createFirstLogin } from \"../graphql/mutations\";\nimport { listTrackings } from '../graphql/queries';\nimport { graphqlOperation, API } from \"aws-amplify\";\nimport { history } from '../AppWithAuth';\nimport firstSurvey from '../survey/FirstServey';\nimport finalSurvey from '../survey/FinalSurvey';\nSurvey.StylesManager.applyTheme(\"orange\");\n\nclass SurveyComponent extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      isCompleted: false,\n      finalResult: \"\",\n      hotelLocation: \"\"\n    };\n\n    this.onCompleteComponent = async result => {\n      try {\n        if (this.props.hotelLocation === \"\") {\n          this.setState({\n            HotelLocation: result.data.HotelLocation\n          });\n          await API.graphql(graphqlOperation(createFirstLogin, {\n            input: {\n              'Email': this.props.userAttributes.email,\n              'Sub': this.props.userAttributes.sub,\n              'LocationHotel': result.data.HotelLocation\n            }\n          }));\n        } else {\n          this.setState({\n            HotelLocation: this.props.hotelLocation\n          });\n        }\n\n        const trakings = await API.graphql(graphqlOperation(listTrackings, {\n          filter: {\n            and: [{\n              Sub: {\n                eq: this.props.userAttributes.sub\n              },\n              Week: {\n                eq: 'W1'\n              }\n            }]\n          }\n        }));\n\n        if (trakings.data.listTrackings.items.length === 0) {\n          var Week = 'W1'; //Page1 \n\n          var HotelLocation = this.state.hotelLocation;\n          var IsHotelClosed = result.data.IsHotelClosed;\n          var HotelReopeningDate = result.data.HotelReopeningDate;\n          var IsHotelContainmentZone = result.data.isHotelContainmentZone;\n          var HotelContainmentEndDate = result.data.HotelContainmentEndDate; //Page 2\n\n          var NbBookings = NbBookings;\n          var NbRoomNightsBooked = NbRoomNightsBooked;\n          var NbRoomNightsCanceled = NbRoomNightsCanceled;\n          var NbRoomNightsBookedFIT = result.data['SplitTotalRoomsBusinessSegment']['FIT'].NbRoomsNightsBS;\n          var NbRoomNightsBookedMICE = result.data['SplitTotalRoomsBusinessSegment']['MICE'].NbRoomsNightsBS;\n          var NbRoomNightsBookedCorporate = result.data['SplitTotalRoomsBusinessSegment']['Corporate'].NbRoomsNightsBS;\n          var RemainingRoomNightsBySegment = result.data['SplitTotalRoomsBusinessSegment-total'].NbRoomsNightsBS;\n          var RoomNightsCountry1 = result.data['RoomsNightsSplit']['Country1'].Country;\n          var NbRoomNightsBookedCountry1 = result.data['RoomsNightsSplit']['Country1'].NbRoomNights;\n          var RoomNightsCountry2 = result.data['RoomsNightsSplit']['Country2'].Country;\n          var NbRoomNightsBookedCountry2 = result.data['RoomsNightsSplit']['Country2'].NbRoomNights;\n          var RoomNightsCountry3 = result.data['RoomsNightsSplit']['Country3'].Country;\n          var NbRoomNightsBookedCountry3 = result.data['RoomsNightsSplit']['Country3'].NbRoomNights;\n          var RoomNightsCountry4 = result.data['RoomsNightsSplit']['Country4'].Country;\n          var NbRoomNightsBookedCountry4 = result.data['RoomsNightsSplit']['Country4'].NbRoomNights;\n          var RoomNightsCountry5 = result.data['RoomsNightsSplit']['Country5'].Country;\n          var NbRoomNightsBookedCountry5 = result.data['RoomsNightsSplit']['Country5'].NbRoomNights;\n          var NbRoomNightsBookedLastWeekApril = result.data['SplitByMonth']['NbRoomsByMonth'].M1;\n          var NbRoomNightsBookedLastWeekMay = result.data['SplitByMonth']['NbRoomsByMonth'].M2;\n          var NbRoomNightsBookedLastWeekJune = result.data['SplitByMonth']['NbRoomsByMonth'].M3;\n          var NbRoomNightsBookedLastWeekJuly = result.data['SplitByMonth']['NbRoomsByMonth'].M4;\n          var NbRoomNightsBookedLastWeekAugust = result.data['SplitByMonth']['NbRoomsByMonth'].M5;\n          var NbRoomNightsBookedLastWeekSeptember = result.data['SplitByMonth']['NbRoomsByMonth'].M6;\n          var TotalNightsBookedLastWeek = result.data['SplitByMonth']['NbRoomsByMonth'].M7; //Page 3\n\n          var TotalNumberRoomAvailable = result.data.TotalNumberRoomAvailable;\n          var NbOccupiedRoomNightsAvril = result.data['SplitTotalRoomAvailable']['NbOfOccupiedRooms'].M1;\n          var NbOccupiedRoomNightsMay = result.data['SplitTotalRoomAvailable']['NbOfOccupiedRooms'].M2;\n          var NbOccupiedRoomNightsJune = result.data['SplitTotalRoomAvailable']['NbOfOccupiedRooms'].M3;\n          var NbOccupiedRoomNightsJuly = result.data['SplitTotalRoomAvailable']['NbOfOccupiedRooms'].M4;\n          var NbOccupiedRoomNightsAugust = result.data['SplitTotalRoomAvailable']['NbOfOccupiedRooms'].M5;\n          var NbOccupiedRoomNightsSeptember = result.data['SplitTotalRoomAvailable']['NbOfOccupiedRooms'].M6;\n          var NbTotalRoomNightsAvril = result.data['SplitTotalRoomAvailable']['TotalRoomNightAvailable'].M1;\n          var NbTotalRoomNightsMay = result.data['SplitTotalRoomAvailable']['TotalRoomNightAvailable'].M2;\n          var NbTotalRoomNightsJune = result.data['SplitTotalRoomAvailable']['TotalRoomNightAvailable'].M3;\n          var NbTotalRoomNightsJuly = result.data['SplitTotalRoomAvailable']['TotalRoomNightAvailable'].M4;\n          var NbTotalRoomNightsAugust = result.data['SplitTotalRoomAvailable']['TotalRoomNightAvailable'].M5;\n          var NbTotalRoomNightsSeptember = result.data['SplitTotalRoomAvailable']['TotalRoomNightAvailable'].M6;\n          var OccupancyRateApril = result.data['SplitTotalRoomAvailable-total'].M1;\n          var OccupancyRateMay = result.data['SplitTotalRoomAvailable-total'].M2;\n          var OccupancyRateJune = result.data['SplitTotalRoomAvailable-total'].M3;\n          var OccupancyRateJuly = result.data['SplitTotalRoomAvailable-total'].M4;\n          var OccupancyRateAugust = result.data['SplitTotalRoomAvailable-total'].M5;\n          var OccupancyRateSeptember = result.data['SplitTotalRoomAvailable-total'].M6; //\n\n          var Result = result.data; //await API.graphql(graphqlOperation(createTracking, {input:{'Email':this.props.userAttributes.email, 'Sub':this.props.userAttributes.sub, Week }}));\n\n          await API.graphql(graphqlOperation(createSurvey, {\n            input: {\n              IsHotelClosed,\n              IsHotelContainmentZone,\n              HotelContainmentEndDate,\n              HotelReopeningDate,\n              NbBookings,\n              NbRoomNightsBooked,\n              NbRoomNightsCanceled,\n              NbRoomNightsBookedFIT,\n              NbRoomNightsBookedMICE,\n              NbRoomNightsBookedCorporate,\n              RemainingRoomNightsBySegment,\n              RoomNightsCountry1,\n              NbRoomNightsBookedCountry1,\n              RoomNightsCountry2,\n              NbRoomNightsBookedCountry2,\n              RoomNightsCountry3,\n              NbRoomNightsBookedCountry3,\n              RoomNightsCountry4,\n              NbRoomNightsBookedCountry4,\n              RoomNightsCountry5,\n              NbRoomNightsBookedCountry5,\n              NbRoomNightsBookedLastWeekApril,\n              NbRoomNightsBookedLastWeekMay,\n              NbRoomNightsBookedLastWeekAugust,\n              NbRoomNightsBookedLastWeekSeptember,\n              TotalNightsBookedLastWeek,\n              NbRoomNightsBookedLastWeekJune,\n              NbRoomNightsBookedLastWeekJuly,\n              TotalNumberRoomAvailable,\n              NbOccupiedRoomNightsAvril,\n              NbOccupiedRoomNightsAugust,\n              NbOccupiedRoomNightsJuly,\n              NbOccupiedRoomNightsJune,\n              NbOccupiedRoomNightsMay,\n              NbOccupiedRoomNightsSeptember,\n              NbTotalRoomNightsAugust,\n              NbTotalRoomNightsAvril,\n              NbTotalRoomNightsJuly,\n              NbTotalRoomNightsJune,\n              NbTotalRoomNightsMay,\n              NbTotalRoomNightsSeptember,\n              OccupancyRateApril,\n              OccupancyRateAugust,\n              OccupancyRateJuly,\n              OccupancyRateJune,\n              OccupancyRateMay,\n              OccupancyRateSeptember,\n              Week,\n              Result\n            }\n          }));\n          this.setState({\n            isCompleted: true\n          });\n          history.push('/Final');\n        } else {\n          history.push('/FinalRetry');\n        }\n      } catch (err) {\n        console.error(\"error during delete\", err);\n      }\n    };\n  }\n\n  render() {\n    var json = this.props.hotelLocation === \"\" ? firstSurvey : finalSurvey;\n    var surveyRender = !this.state.isCompleted ? /*#__PURE__*/React.createElement(Survey.Survey, {\n      json: json //data={data}\n      ,\n      showCompletedPage: false,\n      onComplete: this.onCompleteComponent,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 7\n      }\n    }) : null;\n    /*var onCompleteComponent = this.state.isCompleted ? (\n    ) : null;*/\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 7\n      }\n    }, surveyRender);\n  }\n\n}\n\nexport default SurveyComponent;","map":{"version":3,"sources":["/Users/christophe/dev/amplify/glh-survey/src/components/SurveyComponent.js"],"names":["React","Component","Survey","createSurvey","createTracking","createFirstLogin","listTrackings","graphqlOperation","API","history","firstSurvey","finalSurvey","StylesManager","applyTheme","SurveyComponent","state","isCompleted","finalResult","hotelLocation","onCompleteComponent","result","props","setState","HotelLocation","data","graphql","input","userAttributes","email","sub","trakings","filter","and","Sub","eq","Week","items","length","IsHotelClosed","HotelReopeningDate","IsHotelContainmentZone","isHotelContainmentZone","HotelContainmentEndDate","NbBookings","NbRoomNightsBooked","NbRoomNightsCanceled","NbRoomNightsBookedFIT","NbRoomsNightsBS","NbRoomNightsBookedMICE","NbRoomNightsBookedCorporate","RemainingRoomNightsBySegment","RoomNightsCountry1","Country","NbRoomNightsBookedCountry1","NbRoomNights","RoomNightsCountry2","NbRoomNightsBookedCountry2","RoomNightsCountry3","NbRoomNightsBookedCountry3","RoomNightsCountry4","NbRoomNightsBookedCountry4","RoomNightsCountry5","NbRoomNightsBookedCountry5","NbRoomNightsBookedLastWeekApril","M1","NbRoomNightsBookedLastWeekMay","M2","NbRoomNightsBookedLastWeekJune","M3","NbRoomNightsBookedLastWeekJuly","M4","NbRoomNightsBookedLastWeekAugust","M5","NbRoomNightsBookedLastWeekSeptember","M6","TotalNightsBookedLastWeek","M7","TotalNumberRoomAvailable","NbOccupiedRoomNightsAvril","NbOccupiedRoomNightsMay","NbOccupiedRoomNightsJune","NbOccupiedRoomNightsJuly","NbOccupiedRoomNightsAugust","NbOccupiedRoomNightsSeptember","NbTotalRoomNightsAvril","NbTotalRoomNightsMay","NbTotalRoomNightsJune","NbTotalRoomNightsJuly","NbTotalRoomNightsAugust","NbTotalRoomNightsSeptember","OccupancyRateApril","OccupancyRateMay","OccupancyRateJune","OccupancyRateJuly","OccupancyRateAugust","OccupancyRateSeptember","Result","push","err","console","error","render","json","surveyRender"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport * as Survey from \"survey-react\";\nimport \"survey-react/survey.css\";\nimport { createSurvey, createTracking, createFirstLogin } from \"../graphql/mutations\";\nimport { listTrackings } from '../graphql/queries';\nimport { graphqlOperation, API } from \"aws-amplify\";\nimport { history } from '../AppWithAuth';\nimport firstSurvey from '../survey/FirstServey';\nimport finalSurvey from '../survey/FinalSurvey';\n\nSurvey.StylesManager.applyTheme(\"orange\");\n\nclass SurveyComponent extends Component {\n\n  state = {\n    isCompleted : false,\n    finalResult : \"\", \n    hotelLocation : \"\"\n  }\n\n  onCompleteComponent = async (result) => {\n    try {\n      if (this.props.hotelLocation === \"\"){\n        this.setState({ HotelLocation : result.data.HotelLocation });\n        await API.graphql(graphqlOperation(createFirstLogin, {input:{'Email':this.props.userAttributes.email, 'Sub':this.props.userAttributes.sub,'LocationHotel':result.data.HotelLocation}}));\n      } else {\n        this.setState({ HotelLocation : this.props.hotelLocation });\n      }\n\n      const trakings = await API.graphql(graphqlOperation(listTrackings,  {\n          filter: {\n              and : [{\n              Sub: {\n                  eq: this.props.userAttributes.sub\n              },\n              Week:{\n                eq : 'W1'\n              }\n            }]\n          }\n        }));\n\n      if (trakings.data.listTrackings.items.length === 0) {\n       \n        var Week = 'W1'\n        //Page1 \n        var HotelLocation = this.state.hotelLocation;\n        var IsHotelClosed = result.data.IsHotelClosed;\n        var HotelReopeningDate = result.data.HotelReopeningDate;\n        var IsHotelContainmentZone = result.data.isHotelContainmentZone;\n        var HotelContainmentEndDate = result.data.HotelContainmentEndDate;\n\n        //Page 2\n\n        var NbBookings = NbBookings;\n        var NbRoomNightsBooked = NbRoomNightsBooked;\n        var NbRoomNightsCanceled = NbRoomNightsCanceled;\n\n        var  NbRoomNightsBookedFIT = result.data['SplitTotalRoomsBusinessSegment']['FIT'].NbRoomsNightsBS;\n        var  NbRoomNightsBookedMICE = result.data['SplitTotalRoomsBusinessSegment']['MICE'].NbRoomsNightsBS;\n        var  NbRoomNightsBookedCorporate = result.data['SplitTotalRoomsBusinessSegment']['Corporate'].NbRoomsNightsBS;\n        var  RemainingRoomNightsBySegment = result.data['SplitTotalRoomsBusinessSegment-total'].NbRoomsNightsBS;\n     \n        var  RoomNightsCountry1 = result.data['RoomsNightsSplit']['Country1'].Country;\n        var  NbRoomNightsBookedCountry1 = result.data['RoomsNightsSplit']['Country1'].NbRoomNights;\n        var  RoomNightsCountry2 = result.data['RoomsNightsSplit']['Country2'].Country;\n        var  NbRoomNightsBookedCountry2 = result.data['RoomsNightsSplit']['Country2'].NbRoomNights;\n        var  RoomNightsCountry3 = result.data['RoomsNightsSplit']['Country3'].Country;\n        var  NbRoomNightsBookedCountry3 = result.data['RoomsNightsSplit']['Country3'].NbRoomNights;\n        var  RoomNightsCountry4 = result.data['RoomsNightsSplit']['Country4'].Country;\n        var  NbRoomNightsBookedCountry4 = result.data['RoomsNightsSplit']['Country4'].NbRoomNights;\n        var  RoomNightsCountry5 = result.data['RoomsNightsSplit']['Country5'].Country;\n        var  NbRoomNightsBookedCountry5 = result.data['RoomsNightsSplit']['Country5'].NbRoomNights;\n\n        var  NbRoomNightsBookedLastWeekApril = result.data['SplitByMonth']['NbRoomsByMonth'].M1;\n        var  NbRoomNightsBookedLastWeekMay = result.data['SplitByMonth']['NbRoomsByMonth'].M2;\n        var  NbRoomNightsBookedLastWeekJune = result.data['SplitByMonth']['NbRoomsByMonth'].M3;\n        var  NbRoomNightsBookedLastWeekJuly = result.data['SplitByMonth']['NbRoomsByMonth'].M4;\n        var  NbRoomNightsBookedLastWeekAugust = result.data['SplitByMonth']['NbRoomsByMonth'].M5;\n        var  NbRoomNightsBookedLastWeekSeptember = result.data['SplitByMonth']['NbRoomsByMonth'].M6;\n        var  TotalNightsBookedLastWeek = result.data['SplitByMonth']['NbRoomsByMonth'].M7;\n        \n        //Page 3\n        var TotalNumberRoomAvailable = result.data.TotalNumberRoomAvailable;\n        var  NbOccupiedRoomNightsAvril= result.data['SplitTotalRoomAvailable']['NbOfOccupiedRooms'].M1;\n        var  NbOccupiedRoomNightsMay=  result.data['SplitTotalRoomAvailable']['NbOfOccupiedRooms'].M2;\n        var  NbOccupiedRoomNightsJune=  result.data['SplitTotalRoomAvailable']['NbOfOccupiedRooms'].M3;\n        var  NbOccupiedRoomNightsJuly=  result.data['SplitTotalRoomAvailable']['NbOfOccupiedRooms'].M4;\n        var  NbOccupiedRoomNightsAugust=  result.data['SplitTotalRoomAvailable']['NbOfOccupiedRooms'].M5;\n        var  NbOccupiedRoomNightsSeptember=  result.data['SplitTotalRoomAvailable']['NbOfOccupiedRooms'].M6;\n        var  NbTotalRoomNightsAvril=  result.data['SplitTotalRoomAvailable']['TotalRoomNightAvailable'].M1;\n        var  NbTotalRoomNightsMay=  result.data['SplitTotalRoomAvailable']['TotalRoomNightAvailable'].M2;\n        var  NbTotalRoomNightsJune=  result.data['SplitTotalRoomAvailable']['TotalRoomNightAvailable'].M3;\n        var  NbTotalRoomNightsJuly=  result.data['SplitTotalRoomAvailable']['TotalRoomNightAvailable'].M4;\n        var  NbTotalRoomNightsAugust=  result.data['SplitTotalRoomAvailable']['TotalRoomNightAvailable'].M5;\n        var  NbTotalRoomNightsSeptember=  result.data['SplitTotalRoomAvailable']['TotalRoomNightAvailable'].M6;\n        var OccupancyRateApril = result.data['SplitTotalRoomAvailable-total'].M1;\n        var OccupancyRateMay =result.data['SplitTotalRoomAvailable-total'].M2;\n        var OccupancyRateJune =result.data['SplitTotalRoomAvailable-total'].M3;\n        var OccupancyRateJuly =result.data['SplitTotalRoomAvailable-total'].M4;\n        var OccupancyRateAugust =result.data['SplitTotalRoomAvailable-total'].M5;\n        var OccupancyRateSeptember =result.data['SplitTotalRoomAvailable-total'].M6;\n\n        //\n      var Result = result.data;\n        \n\n        //await API.graphql(graphqlOperation(createTracking, {input:{'Email':this.props.userAttributes.email, 'Sub':this.props.userAttributes.sub, Week }}));\n        await API.graphql(graphqlOperation(createSurvey, {input:{ IsHotelClosed, IsHotelContainmentZone, HotelContainmentEndDate, HotelReopeningDate, \n          NbBookings, NbRoomNightsBooked, NbRoomNightsCanceled,\n          NbRoomNightsBookedFIT, NbRoomNightsBookedMICE, NbRoomNightsBookedCorporate, RemainingRoomNightsBySegment,\n          RoomNightsCountry1, NbRoomNightsBookedCountry1, RoomNightsCountry2, NbRoomNightsBookedCountry2, RoomNightsCountry3, NbRoomNightsBookedCountry3,\n          RoomNightsCountry4, NbRoomNightsBookedCountry4, RoomNightsCountry5, NbRoomNightsBookedCountry5, NbRoomNightsBookedLastWeekApril, NbRoomNightsBookedLastWeekMay,\n          NbRoomNightsBookedLastWeekAugust, NbRoomNightsBookedLastWeekSeptember, TotalNightsBookedLastWeek, NbRoomNightsBookedLastWeekJune, NbRoomNightsBookedLastWeekJuly,\n          TotalNumberRoomAvailable, NbOccupiedRoomNightsAvril,NbOccupiedRoomNightsAugust, NbOccupiedRoomNightsJuly, NbOccupiedRoomNightsJune, NbOccupiedRoomNightsMay,\n          NbOccupiedRoomNightsSeptember,NbTotalRoomNightsAugust, NbTotalRoomNightsAvril, NbTotalRoomNightsJuly, NbTotalRoomNightsJune, NbTotalRoomNightsMay, NbTotalRoomNightsSeptember, \n         OccupancyRateApril, OccupancyRateAugust, OccupancyRateJuly, OccupancyRateJune, OccupancyRateMay, OccupancyRateSeptember, Week, Result, \n        } }));\n        \n        this.setState({ isCompleted: true});\n        history.push('/Final');\n      } else {\n        history.push('/FinalRetry');\n      }\n\n\n     \n    } catch (err) {\n      console.error(\"error during delete\", err);\n    }\n  }\n\n  render() {\n\n\n   \n    var json = (this.props.hotelLocation === \"\")? firstSurvey : finalSurvey;\n    \n\n    var surveyRender = !this.state.isCompleted ? (\n      <Survey.Survey\n        json={json}\n        //data={data}\n        showCompletedPage={false}\n        onComplete={this.onCompleteComponent}\n      />\n    ) : null;\n\n    \n    /*var onCompleteComponent = this.state.isCompleted ? (\n    ) : null;*/\n\n    return (\n      <div>\n        {surveyRender}\n      </div>\n    );\n  }\n}\n\nexport default SurveyComponent;"]},"metadata":{},"sourceType":"module"}